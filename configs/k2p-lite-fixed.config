# ==================== 目标配置 ====================
CONFIG_TARGET_ramips=y
CONFIG_TARGET_ramips_mt7621=y
CONFIG_TARGET_ramips_mt7621_DEVICE_phicomm_k2p=y

# ==================== 镜像格式 ====================
CONFIG_TARGET_ROOTFS_SQUASHFS=y
CONFIG_TARGET_IMAGES_GZIP=y
CONFIG_TARGET_KERNEL_PARTSIZE=16

# ==================== 基础系统 ====================
CONFIG_PACKAGE_base-files=y
CONFIG_PACKAGE_busybox=y
CONFIG_PACKAGE_dropbear=y
CONFIG_PACKAGE_firewall=y
CONFIG_PACKAGE_fstools=y
CONFIG_PACKAGE_luci=y
CONFIG_PACKAGE_luci-base=y
CONFIG_PACKAGE_luci-compat=y
CONFIG_PACKAGE_luci-theme-bootstrap=y
CONFIG_PACKAGE_luci-i18n-base-zh-cn=y

# ==================== 网络 ====================
CONFIG_PACKAGE_dnsmasq=y
CONFIG_PACKAGE_odhcpd-ipv6only=y
CONFIG_PACKAGE_ip6tables=y
CONFIG_PACKAGE_iptables=y

# ==================== K2P驱动 ====================
CONFIG_PACKAGE_kmod-mt7621=y
CONFIG_PACKAGE_kmod-mt7603=y
CONFIG_PACKAGE_kmod-mt76x2=y
CONFIG_PACKAGE_kmod-cfg80211=y
CONFIG_PACKAGE_kmod-mac80211=y
CONFIG_PACKAGE_wpad-basic=y

# ==================== 优化 ====================
CONFIG_TARGET_OPTIMIZATION="-Os -pipe -mcpu=1004kc"
# ==================== K2P精简优化版（修复版） ====================
CONFIG_TARGET_ROOTFS_PARTSIZE=96

# ==================== 移除可能冲突的包 ====================
# 注释掉可能引起libnettle冲突的包
# CONFIG_PACKAGE_luci-app-ssr-plus=y  # SSR可能依赖libnettle
# CONFIG_PACKAGE_shadowsocksr-libev-ssr-redir=y
# CONFIG_PACKAGE_shadowsocksr-libev-ssr-local=y

# 暂时移除wireguard（也可能依赖libnettle）
# CONFIG_PACKAGE_luci-app-wireguard=y
# CONFIG_PACKAGE_wireguard-tools=y

# ==================== 保留核心功能 ====================
# 系统工具
CONFIG_PACKAGE_nano=y
CONFIG_PACKAGE_curl=y
CONFIG_PACKAGE_wget=y
CONFIG_PACKAGE_openssh-server=y
CONFIG_PACKAGE_tar=y
CONFIG_PACKAGE_gzip=y
CONFIG_PACKAGE_unzip=y

# 网络优化
CONFIG_PACKAGE_luci-app-turboacc=y

# 基础网络功能
CONFIG_PACKAGE_luci-app-upnp=y
CONFIG_PACKAGE_luci-app-ddns=y
CONFIG_PACKAGE_ddns-scripts=y

# DNS优化
CONFIG_PACKAGE_dnsmasq-full=y

# LuCI管理界面
CONFIG_PACKAGE_luci-app-firewall=y
CONFIG_PACKAGE_luci-app-opkg=y
CONFIG_PACKAGE_luci-app-commands=y
CONFIG_PACKAGE_luci-app-filetransfer=y
CONFIG_PACKAGE_luci-app-statistics=y
CONFIG_PACKAGE_luci-app-wol=y
CONFIG_PACKAGE_luci-app-uhttpd=y

# 广告过滤
CONFIG_PACKAGE_luci-app-adblock=y

# 网络工具
CONFIG_PACKAGE_traceroute=y
CONFIG_PACKAGE_mtr=y
CONFIG_PACKAGE_ethtool=y

# 多语言支持
CONFIG_PACKAGE_luci-i18n-base-zh-cn=y
CONFIG_PACKAGE_luci-i18n-firewall-zh-cn=y
CONFIG_PACKAGE_luci-i18n-opkg-zh-cn=y
CONFIG_PACKAGE_luci-i18n-upnp-zh-cn=y
CONFIG_PACKAGE_luci-i18n-ddns-zh-cn=y
CONFIG_PACKAGE_luci-i18n-turboacc-zh-cn=y
CONFIG_PACKAGE_luci-i18n-adblock-zh-cn=y
CONFIG_PACKAGE_luci-i18n-commands-zh-cn=y

# 编译优化
CONFIG_DEBUG=n
CONFIG_STRIP=y
